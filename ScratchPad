let
    // WVDCOnnections KQL
    Source = AzureDataExplorer.Contents(LAWClusterURLAVD, LAWNameAVD, "WVDConnections#(lf)| where TimeGenerated >= ago(30d)#(lf)| extend UserName = trim(@""\s"", tolower(UserName))#(lf)| distinct UserName", [MaxRows=null, MaxSize=null, NoTruncate=null, AdditionalSetStatements=null])
in
    Source

let
    // Source query from Azure Data Explorer for WVDConnections
    Source = AzureDataExplorer.Contents(
        LAWClusterURLAVD, 
        LAWNameAVD, 
        "WVDConnections" &
        "#(lf)| where TimeGenerated >= ago(30d)" &                      // Filter for data from the last 30 days
        "#(lf)| extend UserName = trim(@""\\s"", tolower(UserName))" &   // Trim and lowercase UserName
        "#(lf)| distinct UserName",                                     // Select distinct UserNames
        [MaxRows=null, MaxSize=null, NoTruncate=null, AdditionalSetStatements=null]
    )
in
    Source

