WVDConnections
| where State == "Started"
| where ("no_host_selected" == "no_host_selected" or trim_end("[.].*", SessionHostName) == "no_host_selected")
| distinct TimeGenerated, CorrelationId, PredecessorConnectionId, SessionHostName, _ResourceId // Include PredecessorConnectionId and SessionHostName
| join kind = leftsemi
    (
    checkpoints
    | where Source == "RDStack"
        and Name == "RdpStackConnectionEstablished"
        |project CorrelationId, Parameters
    )
    on CorrelationId
