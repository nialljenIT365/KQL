let
    Source = AzureDataExplorer.Contents("https://ade.loganalytics.io/subscriptions/58cb357e-51af-4f62-8982-a8c2b9059362/resourcegroups/rg-eus-desktopmanagement-nerdio-weu-prd/providers/microsoft.operationalinsights/workspaces/nmw-app-law-fwjv4wn75m4qg", "nmw-app-law-fwjv4wn75m4qg", "WVDConnections#(lf)| where TimeGenerated >= ago(30d)#(lf)| where State in (""Connected"")#(lf)| extend Protocol = iff(UdpUse in (""0"", ""<>""), ""TCP"", ""UDP"")#(lf)| extend ClientType = iff(#(lf)                          ClientType == ""com.microsoft.rdc.windows.msrdc.x64"", ""Windows RD Client x64 (MSI)"",#(lf)                          iff(ClientType == ""com.igel.rdc.linux"", ""IGEL"",#(lf)                          iff(ClientType == ""com.microsoft.rdc.windows.store"", ""Windows RD Client Store App"",#(lf)                          iff(ClientType == ""com.microsoft.rdc.html"", ""Web Browser (HTML5)"",#(lf)                          iff(ClientType == ""com.microsoft.rdc.macos"", ""MAC OS"",#(lf)                          iff(ClientType == ""com.microsoft.rdc.windows.msrdc.arm64"", ""Windows RD Client ARM 64 (MSI)"",#(lf)                          iff(ClientType == ""com.microsoft.rdc.ios"", ""iOS"",#(lf)                          iff(ClientType == ""com.microsoft.rdc.windows.msrdc.msix.x64"", ""Windows RD Client x64 (MSIX)"",#(lf)                          iff(ClientType == ""com.microsoft.rdc.windows.wa.msrdc.msix.arm64"", ""Windows App x64 (MSIX)"", ""Other"")))))))))#(lf)| extend Date = format_datetime(TimeGenerated, 'yyyy-MM-dd')  // Adds Date column#(lf)| extend Time = format_datetime(TimeGenerated, 'HH:mm')       // Adds Time column#(lf)| extend TimeKey = replace("":"", """", Time)", [MaxRows=null, MaxSize=null, NoTruncate=null, AdditionalSetStatements=null]),
    #"Changed Type" = Table.TransformColumnTypes(Source,{{"Date", type date}}),
    #"4-fn_ConvertIP4toNumeric" = Table.AddColumn(#"Changed Type", "ClientSideIPAddress-Numeric", each #"4-fn_ConvertIP4toNumeric"([ClientSideIPAddress]))
in
    #"4-fn_ConvertIP4toNumeric"
