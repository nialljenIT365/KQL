WVDConnectionNetworkData
| where TimeGenerated >= ago(30d)
| extend HostPoolName = tostring(split(_ResourceId, '/')[-1])  // Extract value after the last "/"
| extend HostPoolName = trim(' ', tolower(HostPoolName))       // Trim spaces and convert to lowercase
| extend Timekey = format_datetime(TimeGenerated, 'HHmm')      // Adds Timekey column


WVDConnections
| where TimeGenerated >= ago(30d)
| where SessionHostIPAddress != '<>'  // Exclude the literal "<>"
| extend HostPoolName = tostring(split(_ResourceId, '/')[-1])  // Extract value after the last "/"
| extend HostPoolName = trim(' ', tolower(HostPoolName))       // Trim spaces and convert to lowercase
| distinct HostPoolName, SessionHostIPAddress  // Select distinct columns
