| project CorrelationId, TimeGenerated, PredecessorConnectionId, SessionHostName, _ResourceId
| join kind = inner // UserRoute
    (
    checkpoints
    | where Name == "LoadBalancedNewConnection"
    | extend LoadBalanceOutcome = Parameters.LoadBalanceOutcome // Access Parameters column
    | where (newSessions and LoadBalanceOutcome == "NewSession") or (not(newSessions) and LoadBalanceOutcome in ('Disconnected', 'Active'))
    | project CorrelationId, UserRoute=TimeGenerated, LoadBalanceOutcome, Parameters // Include LoadBalanceOutcome if needed
    | distinct CorrelationId, UserRoute
    )
    on CorrelationId


| join kind = inner


WVDConnections
| where State == "Started"
| where ("no_host_selected" == "no_host_selected" or trim_end("[.].*", SessionHostName) == "no_host_selected")
| distinct TimeGenerated, CorrelationId, PredecessorConnectionId, SessionHostName, _ResourceId // Include PredecessorConnectionId and SessionHostName
| join kind = leftsemi
    (
    checkpoints
    | where Source == "RDStack"
        and Name == "RdpStackConnectionEstablished"
        |project CorrelationId, Parameters
    )
    on CorrelationId


A leftsemi join keeps only rows from the left table (WVDConnections) where there is a match in the right table (checkpoints) based on the on condition.
