let
    // Connect to Azure Data Explorer with time range applied directly in KQL
    Source = AzureDataExplorer.Contents(
        "https://ade.loganalytics.io/subscriptions/58cb357e-51af-4f62-8982-a8c2b9059362/resourcegroups/rg-eus-desktopmanagement-nerdio-weu-prd/providers/microsoft.operationalinsights/workspaces/nmw-app-law-fwjv4wn75m4qg",
        "nmw-app-law-fwjv4wn75m4qg",
        "WVDErrors
        | where TimeGenerated >= datetime(" & RangeStart & ") and TimeGenerated <= datetime(" & RangeEnd & ")
        | join kind=leftouter (
            WVDConnections
            | where State == 'Completed'
            | extend Protocol = iff(UdpUse in ('0', '<>'), 'TCP', 'UDP')
        ) on CorrelationId
        | extend ClientType = iff(
            ClientType == 'com.microsoft.rdc.windows.msrdc.x64', 'Windows RD Client x64 (MSI)',
            iff(
                ClientType == 'com.igel.rdc.linux', 'IGEL',
                iff(
                    ClientType == 'com.microsoft.rdc.windows.store', 'Windows RD Client Store App',
                    iff(
                        ClientType == 'com.microsoft.rdc.html', 'Web Browser (HTML5)',
                        iff(
                            ClientType == 'com.microsoft.rdc.macos', 'MAC OS',
                            iff(
                                ClientType == 'com.microsoft.rdc.windows.msrdc.arm64', 'Windows RD Client ARM 64 (MSI)',
                                iff(
                                    ClientType == 'com.microsoft.rdc.ios', 'iOS',
                                    iff(
                                        ClientType == 'com.microsoft.rdc.windows.msrdc.msix.x64', 'Windows RD Client x64 (MSIX)',
                                        iff(ClientType == 'com.microsoft.rdc.windows.wa.msrdc.msix.arm64', 'Windows App x64 (MSIX)', 'Other')
                                    )
                                )
                            )
                        )
                    )
                )
            )
        )
        | order by TimeGenerated desc",
        [MaxRows=null, MaxSize=null, NoTruncate=null, AdditionalSetStatements=null]
    ),

    // Find the current date and time when this query runs
    CurrentDateTime = DateTimeZone.FixedUtcNow(),

    // Add a custom column to record the data load date
    #"Added Custom" = Table.AddColumn(Source, "UTC Data Load Date", each CurrentDateTime, type datetimezone)
in
    #"Added Custom"

Expression.Error: We cannot apply operator & to types Text and DateTime.
Details:
    Operator=&
    Left=WVDErrors
        | where TimeGenerated >= datetime(
    Right=30/10/2024 00:00:00
