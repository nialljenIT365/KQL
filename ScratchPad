let Events = WVDConnections;
Events
| where State == "Connected"
| project CorrelationId, UserName, ResourceAlias, StartTime = TimeGenerated
| join (
    Events
    | where State == "Completed"
    | project EndTime = TimeGenerated, CorrelationId
) on CorrelationId
| project CorrelationId, UserName, ResourceAlias, Duration = EndTime - StartTime
| sort by Duration asc
